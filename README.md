# GhostKey

## Обзор

Мой проект является удобной системой для мониторинга игроков на сервере Этот аддон отслеживает нажатия клавиш и клики мыши в реальном времени и передаёт данные в Node.js-backend. Вся информация сохраняется в базе SQLite, а управление сессиями можно вести прямо через Discord-бота. Для удобства администраторов есть веб-интерфейс, где логи можно просматривать и анализировать в наглядном виде.
Создано специально для Доброграда, с данным проектом ознакомлен D0nBar0n, и в свою очередь получил положительную реакцию с его стороны

## Почему это полезно? 
**Что делает читер, когда его вызывают на проверку? Конечно же выключает читы. И представим, игрока вызвали на проверку - и он решил нажать клавишу открытия чита. Если он вдруг вовсе не перебиндил - то это вызывает много вопросов, но даже, представив, что читер назначил на другую клавишу - проверяющий может задаться вопросом, почему именно на проверке он решил нажать клавишу, которая не подходила под ситуацию? 
(Условно, зачем игроку нажимать клавишу ";" стоя перед администратором?)  Да, в большинстве случаев это не является прямым доказательством, но отследив характерность таких нажатий, можно сделать много выводов.**

## Возможности 
- **Мониторинг в реальном времени**: Отслеживает нажатия клавиш (категоризированные как Обычные, Средние, Подозрительные) и клики мыши с нормализованными координатами.
- **Интеграция с Discord**: Команды бота (`!hotkey`, `!stophotkey`, `!listhotkey`) для управления сессиями, с эмбедами для обновлений статуса сессий.
- **Веб-интерфейс**: Просмотр логов, кликов и статуса онлайн игрока с фильтрацией и экспортом в CSV (сделано для дальнейших скриптов, не требующих размещение на Доброграде для анализа действий пользователя)
- **Управление базой данных**: SQLite для хранения сессий, логов и кликов; автоматическая очистка старых сессий.
- **Безопасность**: API защищен аутентификацией по bearer-токену и ограничением скорости запросов.
- **Интеграция с Garry's Mod**: Серверный скрипт Lua проверяет активные сессии и логирует события, клиентский скрипт захватывает ввод без вывода в консоль.
- **Логи**: В данной версии логируется каждая деталь, но на продакшене стоит убрать лишние логи.

## Как это работает

1. **Создание сессии**: Используется команда бот Discord `!hotkey <steamid>` для запуска мониторинга. Это генерирует уникальный токен и публикует эмбед в указанном канале.
2. **Мониторинг игроков**: Когда игрок с активной сессией присоединяется к серверу, скрипт Lua начинает наблюдать за его вводом. Нажатия клавиш и клики отправляются в API Node.js.
3. **Логирование**: События (вход/выход, клавиши, клики) логируются в базу данных. Нажатия клавиш категоризируются автоматически.
4. **Просмотр данных**: Доступ к веб-просмотрщику через ссылку сессии (например, `/view/<token>`). Сайт автоматически обновляется каждые 5 секунд, показывая отсортированные логи (новые сверху), клики и статус игрока.
5. **Управление сессиями**: Останов сессию командой `!stophotkey <steamid>`, или их просмотр командой `!listhotkey`.

Система обеспечивает отсутствие вывода в консоль на стороне клиента для скрытной работы. Так же думал насчет базовой обсфукицаии, но не реализовано. 
Максимальные ограничения: 100 сессий, 1000 логов/сессию, 50 кликов/сессию. (Вводные данные, в будущем планирую уменьшить количество сессий)


## Конфигурация .env


```
DISCORD_TOKEN=токен
CHANNEL_ID=айди канала 
PORT=3000
PUBLIC_URL=
API_SECRET=Секретный ключ
DB_PATH=./sessions.db
```

- `DISCORD_TOKEN`: ДС токен
- `CHANNEL_ID`: ID канала для эмбедов сессий и списков.
- `PORT`: Порт сервера (по умолчанию 3000).
- `PUBLIC_URL`: Внешний URL для веб-доступа
- `API_SECRET`: Общий секрет для аутентификации API 
- `DB_PATH`: Путь к файлу базы данных SQLite.

## Скриншоты 

<img width="711" height="292" alt="image" src="https://github.com/user-attachments/assets/6d20b1c2-4f1e-4fd4-bc9b-9713657bf349" />

<img width="735" height="496" alt="image" src="https://github.com/user-attachments/assets/137cee29-6cb8-41c9-9a49-e2d5d71d6fdd" />

<img width="1865" height="925" alt="image" src="https://github.com/user-attachments/assets/df516ee2-4dbc-4d17-9bd3-55ab9e1e9f4f" />

<img width="920" height="441" alt="image" src="https://github.com/user-attachments/assets/c6426592-29fa-464b-b102-7571eea53eea" />

## Демонстрация работ с свободными кликами (в большинстве случаев помогает от Lua-читов, нежели чем от полноценных инжектов)

<img width="1599" height="901" alt="image" src="https://github.com/user-attachments/assets/6352542d-251f-4a92-8440-e4384cdf2df7" />

<img width="1920" height="955" alt="image" src="https://github.com/user-attachments/assets/b6dc2bb8-0b47-4a9b-a9ea-0dc2e617d559" />

**Все координаты подстраиваются под экран администратора**

## Credits

**Автор: WiseGenie**
**Специально для OctothorpTeam.**
